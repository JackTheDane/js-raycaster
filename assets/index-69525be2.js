var U=Object.defineProperty;var j=(l,e,n)=>e in l?U(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n;var A=(l,e,n)=>(j(l,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();class J{constructor(e){A(this,"inputElement");this.inputElement=document.querySelector(e)}}class q extends J{constructor(e){super(e),this.setCustomValueAttribute(this.inputElement.value),this.inputElement.addEventListener("change",n=>{var s;this.setCustomValueAttribute((s=n.target)==null?void 0:s.value)})}setCustomValueAttribute(e){this.inputElement.setAttribute("data-value",e.toString())}get value(){return Number.parseFloat(this.inputElement.value)}}class Q{constructor(e,n){A(this,"_mousePosition");this.onMouseClick=n,e.addEventListener("mouseup",this.handleMouseClick.bind(this)),e.addEventListener("contextmenu",this.preventContextMenu.bind(this)),e.addEventListener("mousemove",this.handleMouseMove.bind(this)),e.addEventListener("mouseleave",this.handleMouseLeave.bind(this))}get mousePosition(){return this._mousePosition}handleMouseClick(e){this.onMouseClick(e.x,e.y,e.button===2?"right":"left")}preventContextMenu(e){e.preventDefault()}handleMouseMove(e){this._mousePosition={x:e.x,y:e.y}}handleMouseLeave(){this._mousePosition=void 0}}const x=document.querySelector("canvas"),r=x.getContext("2d"),d=x.width,u=x.height,Z=1/60*1e3,H=.0174533,h=3,D=.05,y=new Set,t={x:300,y:300,deltaX:0,deltaY:0,angle:0},a={xCells:8,yCells:8,cellSize:64},I=[1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,1,1,0,0,0,0,1,0,1,1,0,1,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,1,0,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1];let M=null;const $=(l,e,n,s)=>Math.sqrt((n-l)*(n-l)+(s-e)*(s-e)),k=(l,e)=>$(t.x,t.y,l,e),F=(l,e)=>{const n=l>=d/2,s=e>=u;if(n||s)return null;const i=(l-l%a.cellSize)/a.cellSize,c=(e-e%a.cellSize)/a.cellSize*a.xCells+i;return I[c]==null?null:c},O=(l,e)=>{const n=F(l,e);return n?I[n]:null},V=new q("#field-of-view-input"),_=new q("#number-of-rays-input"),L=new Q(x,(l,e,n)=>{const s=F(l,e);s!=null&&(I[s]=n==="left"?1:0)});function ee(){M=L.mousePosition?F(L.mousePosition.x,L.mousePosition.y):null}function te(){r.clearRect(0,0,d,u)}function le(){r.fillStyle="blue",r.fillRect(d/2,0,d/2,u/2),r.fillStyle="lightblue",r.fillRect(d/2,u/2,d/2,u/2)}function ne(){r.fillStyle="yellow",r.fillRect(t.x-8/2,t.y-8/2,8,8),r.lineWidth=3,r.strokeStyle="yellow",r.beginPath(),r.moveTo(t.x,t.y),r.lineTo(t.x+t.deltaX*10,t.y+t.deltaY*10),r.stroke()}const b=2*Math.PI,v=(l,e)=>O(l,e)===1;function oe(){if(y.has("a")&&(t.angle-=D,t.angle<0&&(t.angle+=b),t.deltaX=Math.cos(t.angle)*h,t.deltaY=Math.sin(t.angle)*h),y.has("d")&&(t.angle+=D,t.angle>b&&(t.angle-=b),t.deltaX=Math.cos(t.angle)*h,t.deltaY=Math.sin(t.angle)*h),y.has("w")){let l=t.x+t.deltaX,e=t.y+t.deltaY;v(l,t.y)&&(l=t.x),v(t.x,e)&&(e=t.y),t.x=l,t.y=e}if(y.has("s")){let l=t.x-t.deltaX,e=t.y-t.deltaY;v(l,t.y)&&(l=t.x),v(t.x,e)&&(e=t.y),t.x=l,t.y=e}}function ie(){x.style.cursor=M==null?"unset":"pointer"}function B(l,e,n){r.fillStyle=l;const s=e*a.cellSize,i=n*a.cellSize;r.fillRect(s+1,i+1,a.cellSize-1,a.cellSize-1)}function se(l){const e=I.at(l);return e==null?void 0:e===1?"black":"white"}function ae(){for(let l=0;l<a.yCells;l++)for(let e=0;e<a.xCells;e++){const n=l*a.xCells+e,s=se(n);if(s==null)return;B(s,e,l)}}function re(){if(M==null)return;const l=M%a.xCells,e=Math.floor(M/a.yCells);B("hsla(0, 0%, 50%, 0.4)",l,e)}const f=8,X=Math.PI/2,W=X*3;function ce(){let l,e,n=0,s=0,i,o=t.angle-H*(V.value/2);const c=d/2/_.value;let P;o<0&&(o+=2*Math.PI),o>2*Math.PI&&(o-=2*Math.PI);for(let E=0;E<_.value;E++){i=0;const C=-Math.tan(o);let z=1e5,R=0,T=0;for(o>X&&o<W?(l=t.x-t.x%a.cellSize-1e-4,e=(t.x-l)*C+t.y,n=-a.cellSize,s=-n*C):o<X||o>W?(l=t.x-t.x%a.cellSize+a.cellSize,e=(t.x-l)*C+t.y,n=a.cellSize,s=-n*C):(l=t.x,e=t.y,i=f);i<f;)O(l,e)===1?(i=f,R=l,T=e,z=k(l,e)):(l+=n,e+=s,i+=1);const g=-1/Math.tan(o);let w=1e5,Y=0,N=0;for(i=0,o>Math.PI?(e=t.y-t.y%a.cellSize-1e-4,l=(t.y-e)*g+t.x,s=-a.cellSize,n=-s*g):o<Math.PI?(e=t.y-t.y%a.cellSize+a.cellSize,l=(t.y-e)*g+t.x,s=a.cellSize,n=-s*g):(l=t.x,e=t.y,i=f);i<f;)O(l,e)===1?(Y=l,N=e,w=k(l,e),i=f):(l+=n,e+=s,i+=1);let p;w<z?(l=Y,e=N,p=w,P="hsl(205 100% 40%)"):(l=R,e=T,p=z,P="hsl(205 100% 35%)"),r.strokeStyle=P,r.lineWidth=1,r.beginPath(),r.moveTo(t.x,t.y),r.lineTo(l,e),r.stroke();let m=t.angle-o;m<0&&(m+=2*Math.PI),m>2*Math.PI&&(m-=2*Math.PI),p=p*Math.cos(m);let S=a.cellSize*u/p;S>u&&(S=u);const G=d/2+c*E,K=u/2-S/2;r.fillStyle=P,r.fillRect(G,K,c+1,S),o+=H*(V.value/_.value),o<0&&(o+=2*Math.PI),o>2*Math.PI&&(o-=2*Math.PI)}}function ue(){te(),ee(),ie(),le(),ae(),ce(),oe(),ne(),re()}function de(){t.deltaX=Math.cos(t.angle)*h,t.deltaY=Math.sin(t.angle)*h,document.addEventListener("keydown",l=>{y.add(l.key)}),document.addEventListener("keyup",l=>{y.delete(l.key)}),setInterval(()=>{window.requestAnimationFrame(ue)},Z)}de();
